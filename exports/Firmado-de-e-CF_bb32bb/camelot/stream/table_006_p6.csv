"signedXml.SigningKey = key"
"signedXml.SignedInfo.SignatureMethod ="
"""http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"""
"Dim reference As Reference = New Reference()"
"reference.AddTransform(New XmlDsigEnvelopedSignatureTransform())"
"reference.DigestMethod = ""http://www.w3.org/2001/04/xmlenc#sha256"""
"reference.Uri = """""
"signedXml.AddReference(reference)"
"Dim keyInfo As KeyInfo = New KeyInfo()"
"keyInfo.AddClause(New KeyInfoX509Data(cert))"
"signedXml.KeyInfo = keyInfo"
"signedXml.ComputeSignature()"
"Dim xmlFirmaDigital As XmlElement = signedXml.GetXml()"
"xmlDoc.DocumentElement.AppendChild(xmlDoc.ImportNode(xmlFirmaDigital, True))"
"Return xmlDoc"
"Catch ex As Exception"
"Throw ex"
"End Try"
"End Function"
