"// Para obtener el certificado de un p12"
"private getCertificateFromP12(p12) {"
"var certData = p12.getBags({ bagType: forge.pki.oids.certBag });"
"var certificate = certData[forge.pki.oids.certBag][0];"
"var pemCertificate = forge.pki.certificateToPem(certificate.cert);"
"pemCertificate = pemCertificate.replace(/\r\n/g, '');"
"var commonName = certificate.cert.subject.attributes[0].value;"
"return { pemCertificate: pemCertificate, commonName: commonName };"
"}"
"// Utilizado para poder realizar la canonicalizaci√≥n de etiquetas del xml."
"private c14nCanonicalization = function (node, options) {"
"options = options || {};"
"var defaultNs = options.defaultNs || """";"
"var defaultNsForPrefix = options.defaultNsForPrefix || {};"
"var ancestorNamespaces = options.ancestorNamespaces || [];"
"var res = this.c14nCanonicalizationInterno(node, [], defaultNs, defaultNsForPrefix,"
"ancestorNamespaces);"
"return res;"
"};"
"private c14nCanonicalizationInterno = function (node, prefixesInScope, defaultNs,"
"defaultNsForPrefix, ancestorNamespaces) {"
"if (node.nodeType === 8) { return this.renderComment(node); }"
"if (node.data) { return this.encodeSpecialCharactersInText(node.data); }"
"var i, pfxCopy"
", ns = this.renderNs(node, prefixesInScope, defaultNs, defaultNsForPrefix,"
"ancestorNamespaces)"
", res = [""<"", node.tagName, ns.rendered, this.renderAttrs(node, ns.newDefaultNs), "">""];"
"for (i = 0; i < node.childNodes.length; ++i) {"
"pfxCopy = prefixesInScope.slice(0);"
"res.push(this.c14nCanonicalizationInterno(node.childNodes[i], pfxCopy, ns.newDefaultNs,"
"defaultNsForPrefix, []));"
"}"
"res.push(""</"", node.tagName, "">"");"
"return res.join("""");"
"};"
"private renderComment = function (node) {"
"if (!this.includeComments) { return """"; }"
"var isOutsideDocument = (node.ownerDocument === node.parentNode),"
