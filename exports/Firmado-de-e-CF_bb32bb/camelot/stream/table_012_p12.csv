"attr = attrListToRender[a];"
"res.push("" "", attr.name, '=""', this.encodeSpecialCharactersInAttribute(attr.value), '""');"
"}"
"return res.join("""");"
"};"
"private renderNs = function(node, prefixesInScope, defaultNs, defaultNsForPrefix,"
"ancestorNamespaces) {"
"var a, i, p, attr"
", res = []"
", newDefaultNs = defaultNs"
", nsListToRender = []"
", currNs = node.namespaceURI || """";"
"// Utilizado para manejar el espacio de nombres del propio nodo"
"if (node.prefix) {"
"if (prefixesInScope.indexOf(node.prefix)==-1) {"
"nsListToRender.push({""prefix"": node.prefix, ""namespaceURI"": node.namespaceURI ||"
"defaultNsForPrefix[node.prefix]});"
"prefixesInScope.push(node.prefix);"
"}"
"}"
"else if (defaultNs!=currNs) {"
"//nuevo  por defecto ns."
"newDefaultNs = node.namespaceURI;"
"res.push(' xmlns=""', newDefaultNs, '""');"
"}"
"// Utilizado para manejar el espacio de nombres de los atributos."
"if (node.attributes) {"
"for (i = 0; i < node.attributes.length; ++i) {"
"attr = node.attributes[i];"
"// Para manejar todos los atributos prefijados que están incluidos en la lista de prefijos y"
"donde el prefijo aún no está definido."
"// Los nuevos prefijos solo se pueden definir mediante `xmlns:`."
"if (attr.prefix === ""xmlns"" && prefixesInScope.indexOf(attr.localName) === -1) {"
"nsListToRender.push({""prefix"": attr.localName, ""namespaceURI"": attr.value});"
"prefixesInScope.push(attr.localName);"
"}"
"//Manejar todos los atributos prefijados que no son definiciones xmlns."
"//Donde el prefijo no está definido ."
"if (attr.prefix && prefixesInScope.indexOf(attr.prefix)==-1 && attr.prefix!=""xmlns"" &&"
"attr.prefix!=""xml"") {"
"nsListToRender.push({""prefix"": attr.prefix, ""namespaceURI"": attr.namespaceURI});"
